# ------------------------------------------------------------------------------------------
# Impression du contenu du fichier de commandes à exécuter :
# ------------------------------------------------------------------------------------------
dt = 0.02
duration = 10
itimes = 500
tend = 10.0
loadr=[] 
DEBUT(PAR_LOT='NON',IGNORE_ALARM=('SUPERVIS_25', 'DISCRETE_26', 'UTILITAI8_56'))

# read mesh
mesh = LIRE_MAILLAGE(UNITE=20)
listr = DEFI_LIST_REEL(DEBUT=0.0,
                       INTERVALLE=_F(JUSQU_A=tend, PAS=dt))

times = DEFI_LIST_INST(DEFI_LIST=_F(LIST_INST=listr, PAS_MINI=1e-8),
                       METHODE='AUTO')
model = AFFE_MODELE(AFFE=(
                            _F(GROUP_MA=('net' ),
                              MODELISATION=('MEMBRANE'),
                              PHENOMENE='MECANIQUE'),
                            _F(GROUP_MA=('edge1','edge2','edge3','edge4'),
                              MODELISATION=('CABLE'),
                              PHENOMENE='MECANIQUE'), ),
                     MAILLAGE=mesh)
 
## define element geometrical properties 
elemprop = AFFE_CARA_ELEM(
                    POUTRE=( ),
                        MEMBRANE=(
                                _F(GROUP_MA=('net'),
                                   ANGL_REP_1=(0.0, 1.0),
                                   ANGL_REP_2=(1.0, 0.0),
                                   EPAIS=1,),),
                        CABLE=( 
                                _F(GROUP_MA=('edge1','edge2','edge3','edge4'),
                                   N_INIT=0.2,  
                                   SECTION=0.000201,),),                  
                MODELE=model)
## material base

mat_1 = DEFI_MATERIAU(ELAS_MEMBRANE=_F(RHO=0.10252, # mass per unit area RHO (density)
                                            #These coefficients have the dimension of a force per length.
                                            M_LLLL=2100000000.0,   #Axial Stiffness along the x-axis.
                                            M_TTTT=2100000000.0,   #Axial Stiffness along the y-axis.
                                            M_LLLT=0.001,  #Shear Stiffness
                                            M_LLTT=0.2,   #Coupling between normal stresses in different directions (x-direction stress influencing y-direction strain and vice versa).
                                            M_LTLT=0.001,  #Coupling between normal stresses and shear strains
                                            M_TTLT=0.001,  #Coupling between normal stresses and shear strains
                                            ))
mat_5 = DEFI_MATERIAU(CABLE=_F(EC_SUR_E=0.0001),
                                ELAS=_F(E=2100000000.0,
                                        NU=0.2,
                                        RHO=910.0))

 ## assign material
fieldmat = AFFE_MATERIAU(AFFE=(
                            _F(GROUP_MA=('net'),
                                MATER=(mat_1)),
                            _F(GROUP_MA=('edge1','edge2','edge3','edge4'),
                                MATER=(mat_5)), ),
                         MODELE=model)

### add load
gF = AFFE_CHAR_MECA(PESANTEUR=_F(DIRECTION=(0.0, 0.0, -1.0),
                                 GRAVITE=9.81,),
                        MODELE=model)
# fixed node
fixed = AFFE_CHAR_MECA(DDL_IMPO=_F(GROUP_NO=('edge1Node'),
                                   DX=0,
                                   DY=0,
                                   DZ=0),
                       MODELE=model)
    
# point load on node
pload = AFFE_CHAR_MECA(FORCE_NODALE=( 
                                    _F(GROUP_NO=('edge3Node'),
                                    FX=0,
                                    FY=-10,
                                    FZ=0,
                                    ),
                                    ),
                       MODELE=model)
                  
loadr.append( _F(CHARGE=gF), )       
loadr.append( _F(CHARGE=fixed), )       
loadr.append( _F(CHARGE=pload), )

# define the dynamic solver

resn = DYNA_NON_LINE(CARA_ELEM=elemprop,
                    CHAM_MATER=fieldmat,
                    COMPORTEMENT=(_F(DEFORMATION='GROT_GDEP',
                                     GROUP_MA=('edge1','edge2','edge3','edge4',
                                                ),
                                     RELATION='CABLE'),),
                    CONVERGENCE=_F(ITER_GLOB_MAXI=1000,
                                   RESI_GLOB_RELA=0.0001 ),
                    EXCIT=(loadr),
                    SCHEMA_TEMPS=_F(FORMULATION='DEPLACEMENT',
                                   SCHEMA="HHT",
                                   ALPHA=-0.3,
                                   ),
                                   #add damping stablize the oscilations Need to study in the future
                    INCREMENT=_F(LIST_INST=times),
                    MODELE=model)
    
# write results
IMPR_RESU(FORMAT='MED',
          RESU=(_F(CARA_ELEM=elemprop,
                   LIST_INST=listr,
                   NOM_CHAM=('DEPL', 'SIEF_ELGA'),
                   RESULTAT=resn,
                   TOUT_CMP='OUI'),
                ),
          UNITE=80)

FIN()

# ------------------------------------------------------------------------------------------

  Ouverture en écriture du fichier ./vola.1

 <INFO> Démarrage de l'exécution.
                                                                                
                                                                                
              -- CODE_ASTER -- VERSION : EXPLOITATION (stable) --               
                                                                                
                     Version 14.6.0 modifiée le 11/06/2020                      
                     révision b3490fa3b76c - branche 'v14'                      
                         Copyright EDF R&D 1991 - 2024                          
                                                                                
                    Exécution du : Thu Aug  8 14:20:03 2024                     
                      Nom de la machine : WIN-GMJLJ727QD5                       
                              Architecture : 64bit                              
                          Type de processeur : x86_64                           
Système d'exploitation : Linux-5.15.153.1-microsoft-standard-WSL2-x86_64-with-glibc2.29
                        Langue des messages : en (UTF-8)                        
                                                                                
                           Version de Python : 3.8.10                           
                           Version de NumPy : 1.17.4                            
   
   !------------------------------------------------------------------------------------!
   ! <A> <SUPERVIS2_2>                                                                  !
   !                                                                                    !
   !     Vous utilisez une vieille version de Code_Aster.                               !
   !                                                                                    !
   !     En mettant à jour votre version, vous bénéficierez des dernières améliorations !
   !     apportées au code depuis 15 mois.                                              !
   !     Si vous avez des développements privés, vous risquez d'avoir un travail        !
   !     important de portage si vous ne suivez pas les mises à jour.                   !
   !                                                                                    !
   !                                                                                    !
   ! Ceci est une alarme. Si vous ne comprenez pas le sens de cette                     !
   ! alarme, vous pouvez obtenir des résultats inattendus !                             !
   !------------------------------------------------------------------------------------!
   
                           Parallélisme MPI : inactif                           
                          Parallélisme OpenMP : actif                           
                        Nombre de processus utilisés : 2                        
                     Version de la librairie HDF5 : 1.10.3                      
                      Version de la librairie MED : 4.0.0                       
                       Librairie MFront : non disponible                        
                     Version de la librairie MUMPS : 5.1.2                      
                        Librairie PETSc : non disponible                        
                     Version de la librairie SCOTCH : 6.0.4                     

                  Mémoire limite pour l'exécution : 5102.00 Mo                  
                   consommée par l'initialisation : 104.88 Mo                   
                  par les objets du jeu de commandes : 0.00 Mo                  
                 reste pour l'allocation dynamique : 4996.10 Mo                 
                Taille limite des fichiers d'échange : 48.00 Go                 
                                                                                

.. __stg1_txt6
  # ------------------------------------------------------------------------------------------
  # Commande No :  0001            Concept de type : -
  # ------------------------------------------------------------------------------------------
  DEBUT(PAR_LOT='NON',
        IGNORE_ALARM=('SUPERVIS_25', 'DISCRETE_26', 'UTILITAI8_56'),
        IMPR_MACRO='NON',
        DEBUG=_F(JXVERI='NON',
                 SDVERI='NON',
                 JEVEUX='NON',
                 HIST_ETAPE='NON',),
        MESURE_TEMPS=_F(NIVE_DETAIL=1,
                        MOYENNE='NON',),
        MEMOIRE=_F(TAILLE_BLOC=800.0,
                   TAILLE_GROUP_ELEM=1000,),
        RESERVE_CPU=_F(BORNE=900,),
        INFO=1,)

   
   !------------------------------------------------------------------------------------!
   ! <A> <SUPERVIS_1>                                                                   !
   !                                                                                    !
   !  L'utilisation du mot-clé PAR_LOT='NON' permet d'accéder en lecture et en écriture !
   !  au contenu des concepts Aster. De ce fait, votre étude est exclue du périmètre    !
   !  qualifié de Code_Aster puisque toutes ses étapes ne peuvent être certifiées.      !
   !                                                                                    !
   !  Conseils :                                                                        !
   !    - Il n'y a pas particulièrement de risque de résultat faux... sauf si votre     !
   !      programmation l'introduit.                                                    !
   !    - Distinguez le calcul lui-même (qui doit sans doute passer en PAR_LOT='OUI')   !
   !      des post-traitements (qui nécessiteraient le mode PAR_LOT='NON') qui peuvent  !
   !      être réalisés en POURSUITE.                                                   !
   !                                                                                    !
   !                                                                                    !
   ! Ceci est une alarme. Si vous ne comprenez pas le sens de cette                     !
   ! alarme, vous pouvez obtenir des résultats inattendus !                             !
   !------------------------------------------------------------------------------------!
   

  Valeur initiale du temps CPU maximum =   9000060 secondes
  Valeur du temps CPU maximum passé aux commandes =   8999160 secondes
  Réserve CPU prévue = 900 secondes

  Ouverture en écriture du fichier ./glob.1

  Ouverture en écriture du fichier ./vola.1

  Ouverture en lecture du fichier /opt/aster146/14.6/lib/aster/elem.1

     Nom de la base                          :  ELEMBASE
     Créée avec la version                   :  14.06.00
     Nombre d'enregistrements utilisés       :  43
     Nombre d'enregistrements maximum        :  512
     Longueur d'enregistrement (octets)      :  819200
     Nombre d'identificateurs utilisés       :  123
     Taille maximum du répertoire            :  300
     Pourcentage d'utilisation du répertoire :  41 %

  Ouverture en lecture du fichier /opt/aster146/14.6/lib/aster/elem.1


     Nom de la base                          :  ELEMBASE
     Nombre d'enregistrements utilisés       :  43
     Nombre d'enregistrements maximum        :  512
     Longueur d'enregistrement (octets)      :  819200
     Nombre total d'accès en lecture         :  60
     Volume des accès en lecture             :         46.88 Mo.
     Nombre total d'accès en écriture        :  0
     Volume des accès en écriture            :          0.00 Mo.
     Nombre d'identificateurs utilisés       :  123
     Taille maximum du répertoire            :  300
     Pourcentage d'utilisation du répertoire :  41 %

  Relecture des catalogues des éléments faite.

  Fin de lecture (durée  0.016399  s.) 
  # Mémoire (Mo) :   150.27 /   142.48 /    44.29 /    22.92 (VmPeak / VmSize / Optimum / Minimum)
  # Fin commande No : 0001   user+syst:        0.03s (syst:        0.02s, elaps:        0.02s)
  # ------------------------------------------------------------------------------------------

.. __stg1_txt9
  # ------------------------------------------------------------------------------------------
  # Commande No :  0002            Concept de type : maillage_sdaster
  # ------------------------------------------------------------------------------------------
  mesh = LIRE_MAILLAGE(UNITE=20,
                       INFO_MED=1,
                       FORMAT='MED',
                       VERI_MAIL=_F(VERIF='OUI',
                                    APLAT=1.E-3,),
                       INFO=1,)

Vérification du maillage.

------------ MAILLAGE mesh     - IMPRESSIONS NIVEAU  1 ------------

JE-08-AOUT-2024 14:20:03                                                        

NOMBRE DE NOEUDS                         441

NOMBRE DE MAILLES                        480
                              SEG2                   80
                              QUAD4                 400

NOMBRE DE GROUPES DE NOEUDS                8
                              allnodes                           441
                              edge1Node                           21
                              edge2Node                           21
                              edge3Node                           21
                              edge4Node                           21
                              n1                                   1
                              n2                                   1
                              n3                                   1

NOMBRE DE GROUPES DE MAILLES               5
                              edge3                               20
                              edge1                               20
                              edge4                               20
                              edge2                               20
                              net                                400

--------------------------------------------------------------------------------

  # Mémoire (Mo) :   150.27 /   144.44 /    44.29 /    22.92 (VmPeak / VmSize / Optimum / Minimum)
  # Fin commande No : 0002   user+syst:        0.01s (syst:        0.00s, elaps:        0.01s)
  # ------------------------------------------------------------------------------------------

.. __stg1_txt10
  # ------------------------------------------------------------------------------------------
  # Commande No :  0004            Concept de type : listr8_sdaster
  # ------------------------------------------------------------------------------------------
  listr = DEFI_LIST_REEL(DEBUT=0.0,
                         INTERVALLE=_F(JUSQU_A=10.0,
                                       PAS=0.02,),
                         INFO=1,)

  # Mémoire (Mo) :   150.27 /   144.44 /    44.29 /    22.92 (VmPeak / VmSize / Optimum / Minimum)
  # Fin commande No : 0004   user+syst:        0.00s (syst:        0.00s, elaps:        0.00s)
  # ------------------------------------------------------------------------------------------

.. __stg1_txt13
  # ------------------------------------------------------------------------------------------
  # Commande No :  0005            Concept de type : list_inst
  # ------------------------------------------------------------------------------------------
  times = DEFI_LIST_INST(METHODE='AUTO',
                         DEFI_LIST=_F(LIST_INST=listr,
                                      PAS_MINI=1.E-08,
                                      NB_PAS_MAXI=1000000,),
                         ADAPTATION=_F(
                                       NB_INCR_SEUIL=2,
                                       NOM_PARA='NB_ITER_NEWTON',
                                       CRIT_COMP='LE',
                                       PCENT_AUGM=100.0,
                                       EVENEMENT='SEUIL',
                                       MODE_CALCUL_TPLUS='FIXE',),
                         ECHEC=_F(SUBD_PAS=4,
                                  SUBD_NIVEAU=3,
                                  SUBD_PAS_MINI=0.0,
                                  SUBD_METHODE='MANUEL',
                                  ACTION='DECOUPE',
                                  EVENEMENT='ERREUR',),
                         INFO=1,)

Gestion automatique de la liste d'instants.
Paramètres de la gestion automatique de la liste d'instants.
Pas minimum:         1E-12
Pas maximum:            10
Nombre de pas maximum: 1000000
La liste d'instants contient 501 pas de temps et le pas de temps minimum vaut          0.02.
Il y a 1 événements.
L'événement 1 est pour capturer les erreurs.
Si cet événement se déclenche, on découpe le pas de temps.
La découpe du pas de temps est manuel.
On découpe le pas de temps en 4 incréments jusqu'à ce que le niveau atteigne 3.
Il y a 1 schémas d'adaptations du pas de temps.
Le schéma d'adaptation 1 du pas de temps se déclenche pour un seuil donné.
Le seuil est franchi quand, 2 fois de suite, on fait exactement ou moins de 2314885530818453504 itérations de Newton.
Le mode de calcul de l'instant suivant est fixe.
Le pas de temps suivant sera modifié de 100.00 %.
  # Mémoire (Mo) :   150.27 /   144.44 /    44.29 /    22.92 (VmPeak / VmSize / Optimum / Minimum)
  # Fin commande No : 0005   user+syst:        0.02s (syst:        0.00s, elaps:        0.01s)
  # ------------------------------------------------------------------------------------------

.. __stg1_txt15
  # ------------------------------------------------------------------------------------------
  # Commande No :  0006            Concept de type : modele_sdaster
  # ------------------------------------------------------------------------------------------
  model = AFFE_MODELE(MAILLAGE=mesh,
                      AFFE=(_F(GROUP_MA=('net', ),
                               PHENOMENE='MECANIQUE',
                               MODELISATION=('MEMBRANE', ),),
                            _F(GROUP_MA=('edge1', 'edge2', 'edge3', 'edge4'),
                               PHENOMENE='MECANIQUE',
                               MODELISATION=('CABLE', ),),
                            ),
                      INFO=1,
                      DISTRIBUTION=_F(PARTITIONNEUR='METIS',
                                      METHODE='SOUS_DOMAINE',),
                      VERI_JACOBIEN='OUI',)


Sur les 480 mailles du maillage mesh, on a demandé l'affectation de 480, on a pu en affecter 480
 Modélisation     Type maille  Élément fini     Nombre
 CABLE            SEG2         MECABL2          80
 MEMBRANE         QUAD4        MEMBQU4          400
#2      Calculs elementaires et assemblages               CPU (USER+SYST/SYST/ELAPS):      0.00      0.00      0.00
  # Mémoire (Mo) :   150.27 /   145.09 /    44.29 /    33.86 (VmPeak / VmSize / Optimum / Minimum)
  # Fin commande No : 0006   user+syst:        0.00s (syst:        0.00s, elaps:        0.00s)
  # ------------------------------------------------------------------------------------------


  <I> Informations sur les temps d'exécution
      Temps cpu user total                    0.17 s
      Temps cpu systeme total                 0.03 s
      Temps elapsed total                     0.20 s
      Temps restant                     8999159.80 s


  La signature de la base sauvegardée est (à l'adresse 0) :
    f6eedcdca56b202ad1defd27a9034955161523ec

 ********************************************************************************
 * COMMAND                  :       USER :     SYSTEM :   USER+SYS :    ELAPSED *
 ********************************************************************************
 * init (jdc)               :       0.17 :       0.03 :       0.20 :       0.21 *
 *  . compile               :       0.00 :       0.00 :       0.00 :       0.00 *
 *  . exec_compile          :       0.08 :       0.03 :       0.11 :       0.10 *
 * DEBUT                    :       0.01 :       0.02 :       0.03 :       0.02 *
 * LIRE_MAILLAGE            :       0.01 :       0.00 :       0.01 :       0.01 *
 * DEFI_LIST_REEL           :       0.00 :       0.00 :       0.00 :       0.00 *
 * DEFI_LIST_INST           :       0.02 :       0.00 :       0.02 :       0.01 *
 * AFFE_MODELE              :       0.00 :       0.00 :       0.00 :       0.00 *
 *  . part Superviseur      :       0.14 :       0.03 :       0.17 :       0.20 *
 *  . part Fortran          :       0.03 :       0.00 :       0.03 :       0.01 *
 ********************************************************************************
 * TOTAL_JOB                :       0.17 :       0.03 :       0.20 :       0.20 *
 ********************************************************************************

ERREUR A L'INTERPRETATION DANS ACCAS - INTERRUPTION
>> JDC.py : DEBUT RAPPORT
CR phase d'initialisation
   Etape : AFFE_CARA_ELEM    ligne : 25    fichier : 'fort.1'
      MEMBRANE
         !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
         ! Règle(s) non respectée(s) :                                               !
         ! - Il ne faut qu un mot clé parmi : ('ANGL_REP_1', 'ANGL_REP_2', 'VECT_1', !
         ! 'VECT_2')                                                                 !
         !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
      Fin MEMBRANE
   Fin Etape : AFFE_CARA_ELEM
fin CR phase d'initialisation

>> JDC.py : FIN RAPPORT
EXECUTION_CODE_ASTER_EXIT_213799=1

 <I>_EXIT_CODE = 1